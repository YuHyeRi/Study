# [DB] DataBase 개념정리 1탄

## 👧 슈퍼키, 후보키, 기본키, 대체키, 외래키

> **외래키**
> 
- 테이블에서 각 행을 유일하게 식별할 수 있는 하나 또는 그 이상의 속성들의 집합이다.
- 유일성이란 하나의 키로 특정 행을 바로 찾아낼 수 있는 고유한 데이터 속성을 말한다.
- 어떤 속성끼리 묶던 슈퍼키는 **유일성**만 만족하면 슈퍼키가 될 수 있다.

> **후보키 (Candidate Key)**
> 
- 테이블에서 각 행을 유일하게 식별할 수 있는 최소한의 속성들의 집합이다.
- 후보키는 기본키가 될 수 있는 후보들이며 **유일성과 최소성**을 동시에 만족해야 한다.

> ***기본키 (Primary Key) → 유니크, Not null***
> 
- 후보키들 중에서 하나를 선택한 키로 **최소성과 유일성**을 만족하는 속성이다.
- 테이블에서 기본키는 오직 1개만 지정할 수 있다. (다중컬럼으로도 설정 가능)
- 기본키는 테이블 안에서 유일하게 각 행들을 구별할 수 있도록 쓰인다.
- 기본키는 NULL 값을 절대 가질 수 ❌, 중복된 값을 가질 수 ❌. 각 행들을 구별하려면 값이 없어선 안되고 중복되어서도 안되기 때문이다.

> **대체키 (Alternate Key)**
> 
- 후보키가 두 개 이상일 경우, 그 중에서 어느 하나를 기본키로 지정하고 남은 후보키들이다.
- 대체키는 기본키로 선정되지 않은 후보키이다. 기본키가 없어시졈 기본키를 대체할 수 ⭕

> **외래키 (Foreign Key)**
> 
- ***테이블이 다른 테이블의 데이터를 참조하여 테이블 간의 관계를 연결하는 것이다.***
- 다른 테이블의 데이터를 참조할 때 없는 값을 참조할 수 없도록 제약을 주는 것이다.
- 참조 될 테이블이 먼저 만들어지고 참조하는 테이블에 값이 입력되어야 한다.
- ***이때, 참조 될 값은 참조 될 테이블에서 기본키로 설정되어 있어야 한다.***
- 부모테이블 먼저 삭제될 수 ❌. 왜냐하면 부모테이블을 참조하는데 부모테이블이 삭제되면 자식테이블은 참조하는 것이 없어지기 때문에 외래키 오류가 발생한다.

🟡 CASCADE : A개체를 변경/삭제할 때, A개체를 참조하고 있는 모든 개체들이 변경/삭제

🟡 RESTRICT : A개체를 변경/삭제할 때, A개체를 참조하고 있는 개체가 존재하면 A개체에 대한 명령(변경/삭제)가 취소

🟡 SET NULL : A개체를 변경/삭제할 때, A개체를 참조하고 있는 모든 개체들의 값은 NULL로 셋팅

🟡 NO ACTION : 부모테이블의 컬럼이 변경/삭제될 때 변경/삭제할 개체만 변경/삭제 (참조하고 있는 개체는 변동❌)

---

## 👧 정규화, 비정규화

> **목적**
> 
1. 불필요한 데이터(data redundancy)를 제거한다.
2. 데이터 저장을 ‘논리적’으로 한다.

> **1차 정규화**
> 

1차 정규형은 각 로우(row)마다 컬럼의 값이 1개씩만 있어야 한다. 

이를 컬럼이 원자값을 갖는다고 한다.

‘ 홍길동 / 수학,과학 ‘ ← 이런식으로 들어가면 ❌

> **2차 정규화**
> 

테이블의 모든 컬럼이 완전 함수적 종속을 만족하는 것이다.

기본키가 다중칼럼인 경우, 기본키 중에 특정 컬럼에만 종속된 컬럼(부분 함수적 종속)이 없어야 한다.

이럴 경우에는 테이블을 쪼개야

2차에서 삽입갱신삭제 이상이 생기면 → 3차 정규화로 

> **3차 정규화**
> 

3차 정규형은 기본키를 제외한 속성들 간의 이행적 함수 종속이 없는 것이다.

기본키 이외의 다른 컬럼이 그 외 다른 컬럼을 결정할 수 없는 것이다.

삼단논법처럼 X→Y, Y→Z, X→Z가 모두 성립할 때, Z가 Y에 의해서도 결정될 수 있기 때문에 테이블을 쪼갠다.

> **BCNF**
> 

X의 값을 알면 Y의 값을 바로 식별할 수 있고, X의 값에 Y의 값이 달라질 때, Y는 X에 함수적 종속이라고 한다. X를 결정자, Y를 종속자라고 한다.

3차 정규형을 조금 더 강화한 버전으로 이는 3차 정규형으로 해결할 수 없는 이상현상을 해결할 수 있다. 3차 정규형을 만족하면서 BCNF는 만족하지 않은 경우는 일반 컬럼이 후보키를 결정하는 경우다. BCNF란 3차 정규형을 만족하면서 모든 결정자가 후보키 집합에 속한 정규형이다.

> **이상의 종류**
> 

새 데이터를 삽입하기 위해 불필요한 데이터도 함께 삽입해야 하는 문제 → 삽입이상

중복 튜플 중 일부만 변경하여 데이터가 불일치하게 되는 모순의 문제 → 갱신이상

튜플을 삭제하면 꼭 필요한 데이터 까지 함께 삭제되는 데이터 손실의 문제 → 삭제이상

<aside>
💡 행 (Row) : 테이블을 구성하는 데이터들 중 가로로 묶은 데이터셋을 의미한다. 일반적으로 행은 한 객체에 대한 정보를 가지고 있다. 이 또한 관계형 데이터베이스에서는 튜플(Tuple) 또는 레코드(Record)라는 이름으로 불린다.

</aside>

<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/83b35ec9-179f-4e48-8d1c-44a0e739e255/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220312T062544Z&X-Amz-Expires=86400&X-Amz-Signature=0d386918e6df8980dab585e17594d27ac18258c99de37abf60f686d7929eb119&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject">

> **함수적 종속의 종류**
> 

***1) 완전 함수적 종속(Full Functional Dependency)***

종속자가 기본키에만 종속되며 기본키가 여러 속성으로 구성되어 있을 경우, 기본키를 구성하는 모든 속성이 포함된 기본키의 부분집합에 종속된 경우

***2) 부분 함수적 종속(Partial Functional Dependency)***

릴레이션에서 종속자가 기본키가 아닌 다른 속성에 종속되거나 기본키가 여러 속성으로 구성되어 있을 경우, 기본키를 구성하는 속성 중 일부만 종속되는 경우

***3) 이행적 함수 종속(Transitive Functional Dependency)***

릴레이션에서 X, Y, Z라는 3개의 속성이 있을 때 X→Y, Y→Z 라는 종속 관계가 있을 때, X→Z가 성립될 때 이행적 함수 종속이라고 한다. 즉, X를 알면 Y를 알고 그를 통해 Z를 알 수 있는 경우를 말한다.

---

## 👧 조인 (Join)

관계형 데이터베이스에서는 중복 데이터를 피하기 위해서 데이터를 쪼개 여러 테이블로 나누어 저장한다. 이렇게 분리되어 저장된 데이터에서 원하는 결과를 다시 도출하기 위해서는 여러 테이블을 조합할 필요가 있다. 관계형 데이터베이스에서는 조인(JOIN) 연산자를 사용하여 관련 있는 컬럼 기준으로 행을 합쳐준다.

<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/73a7338c-8cdd-4b07-976b-b4f57d7c47c4/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220312T062605Z&X-Amz-Expires=86400&X-Amz-Signature=6a2d5aad858f82220533b8c2feab41651ffeec4c0db724ffe372caf1209fd2a5&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject">

> **내부조인 (INNER JOIN) → 교집합**
> 
- ON 또는 WHERE로 두 테이블이 결합하는 조건을 걸어줌
- 두 테이블 모두에 데이터가 있을 경우에만 나오고, 한쪽에만 존재하면 나오지 않음

> **FULL OUTER JOIN → 합집합**
> 
- JOIN 시 좌측, 우측 테이블의 모든 데이터를 읽어 JOIN 하여 결과를 생성
- RIGHT OUTER JOIN과 LEFT OUTER JOIN의 결과를 합집합으로 처리한 결과와 동일
- 단, 중복되는 데이터는 삭제

> **RIGHT & LEFT OUTER JOIN**
> 
- 한쪽에만 값이 존재하는 경우에도 표시하고 싶을 때 사용
- ‘OUTER’ 단어는 생략 가능
- ‘ A LEFT JOIN B ‘ 와 ‘ B RIGHT JOIN A ‘ 는 같은 뜻이다

> **교차조인 (CROSS JOIN)**
> 
- 교차조인은 두 테이블의 카티션 프로덕트를 한 결과이다.
- 특별한 조건 없이 테이블 A의 각 행과 테이블 B의 각 행을 모두 조합한 결과이다.

> **셀프조인 (SELF JOIN)**
> 
- 자기 자신과 조인

---

## 👧 DML, DDL, DCL, TCL

> **DML → 데이터 조작어 (주로 CRUD)**
> 

SELECT, INSERT, UPDATE, DELETE, MERGE

> **DDL → 데이터 정의어**
> 

CREATE, ALTER, DROP, RENAME, TRANCADE

> **DCL → 데이터 제어어 (데이터에 접근할 수 있는 권한들을 관리하는 명령어)**
> 

GRANT, REVOKE

---

## 👧 트랜잭션

논리적인 일의 단위, 한번에 모두 수행되어야 할 일련의 연산들

> **COMMIT**
> 

한 개의 트랜잭션(논리적 단위)에 대한 작업이 성공적으로 끝났고, 데이터베이스가 다시 일관된 상태에 있을 때 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산

> **ROLLBACK**
> 

하나의 트랜잭션 처리가 비정상적으로 종료되어 데이터베이스의 일관성을 깨트렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소(UNDO) 하는 연산이다.

ROLLBACK 시에는 해당 트랜잭션을 재시작하거나 폐기한다.

> **SAVEPOINT [이름]**
> 

현재까지의 트랜잭션을 특정 이름으로 지정하라는 명령. 

ROLLBACK [TO SAVEPOINT 이름]

저장되지 않은 모든 데이터 변경 사항을 취소하고 현재의 트랜잭션을 끝내라는 명령. 만약 이전에 SAVEPOINT로 지정한 이름이 있으면 그 위치까지 되돌아간다.

---

## 👧 ACID

데이터베이스 트랜잭션이 안전하게 수행된다는 것을 보장하기 위한 성질을 가리키는 약어

> **Atomicity (원자성)**
> 
- 트랜잭션의 연산은 데이터베이스에 모두 반영되던지 아니면 전혀 반영되지 않아야 한다.
- 트랜잭션의 작업이 부분적으로 실행되거나 중단되지 않는 것을 보장하는 것을 말한다.

즉, All or Nothing 의 개념으로서 작업단위를 일부분만 실행하지 않는다는 것을 의미

> **Consistency (일관성)**
> 
- 트랜잭션이 성공적으로 완료되면 일관적인 DB상태를 유지하는 것을 말한다.
- 여기서 말하는 일관성이란, 예를 들어 송금 금액의 데이터 타입이 정수형(int)인데 갑자기 문자열( String)이 되지 않는 것을 말한다. 즉, 송금 전 후 모든 금액의 데이터 타입은 정수형(int)이여야 한다는 것이 일관성이다.

> **Isolation (독립성, 격리성)**
> 
- 트랜잭션 수행 시 다른 트랜잭션의 작업이 끼어들지 못하도록 보장하는 것을 말한다. 즉, 트랜잭션끼리는 서로를 간섭할 수 없다.
- 수행 중인 트랜잭션은 완전히 완료될 때 까지 다른 트랜잭션에서 수행결과를 참조할 수 없다.

> **Durablility (영속성, 지속성)**
> 
- 성공적으로 수행된 트랜잭션은 영원히 반영이 되는 것을 말한다.
- commit을 하면 현재 상태는 영원히 보장된다.

👉 노션 : https://www.notion.so/DB-DataBase-1-ece90ec37387415497faf07c48e18575
👉 출처 : [https://buddev.tistory.com/71](https://buddev.tistory.com/71)
